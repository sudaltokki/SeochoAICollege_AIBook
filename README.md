<div align="center">
<h1> [ì¸ê³µì§€ëŠ¥ì´ ë§Œë“œëŠ” ì•„ì´ë“¤ì˜ ê·¸ë¦¼ ë™í™”ì±…] ì•„ì´ë¶ AI-Book </h1>

<img src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/9693e807-f036-46aa-bcaa-8893ee33689b" width="570" />
</div>

<br>

<div align="center">
    <h2> ğŸ“– Overview </h2>
</div>
  
- ì‚¬ìš©ì ì„¤ì •ì— ë”°ë¼ **ê°œì¸í™”ëœ ë™í™”ì±…**ì„ ìƒì„±í•˜ëŠ” ì¸ê³µì§€ëŠ¥ ê¸°ë°˜ì˜ ì›¹ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
- ì‚¬ìš©ìëŠ” ì§ì ‘ ë™í™”ì±…ì˜ ì£¼ì¸ê³µê³¼ ì£¼ì œë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì„œë¹„ìŠ¤ì˜ ì£¼ ì‚¬ìš©ìê°€ ì†Œì•„ í˜¹ì€ ìœ ì•„ì¼ ê²ƒì„ ê³ ë ¤í•˜ì—¬ ì‚¬ìš©ìê°€ ë§í•˜ëŠ” ì£¼ì œë¥¼ ìŒì„±ì¸ì‹ìœ¼ë¡œ ë°›ì•„ì˜¤ë„ë¡ ê¸°íší•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  ì •í™•í•œ ìŒì„±ì¸ì‹ì„ ìœ„í•´ Speech to Text ëª¨ë¸ì¸ **OpenAIì˜ Whisper**ì„ **fine-tuning**í•˜ì—¬ ì†Œì•„/ìœ ì•„ ìŒì„±ì— ë” ì í•©í•œ ëª¨ë¸ì„ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤.
- **GPT-4**ì™€ **Stable diffusion**ì„ ì‚¬ìš©í•´ ë™í™”ì±…ì˜ ì œëª©, ë‚´ìš©, ê·¸ë¦¼ì„ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

<br>

<div align="center">   
    <h2> ğŸ™‹â€â™‚ï¸ Team </h2>
<div>
    
|ë°•ì§€ì›|ì •í•˜ì„±|ì„ë™í¬|ë°•ì£¼ì€|
| :--------: | :--------: | :--------: | :--------: | 
|<img src="https://github.com/sudaltokki.png" width="120" height="120"/>|<img src="https://github.com/HaseongJung.png" width="120" height="120"/>|<img src="https://github.com/star1sh.png" width="120" height="120"/>|<img src="" width="120" height="120"/>|
|[@sudaltokki](https://github.com/sudaltokki)|[@HaseongJung](https://github.com/)|[@star1sh](https://github.com/star1sh)|[@PJuEun](https://github.com/PJuEun)|
|Team Leader, AI|AI|AI|Frontend|

</div>
</div>

<br>

<div align="center">  
    <h2> ğŸ”§ Stacks </h2>
</div>

### AI
![Pytorch](https://img.shields.io/badge/Pytorch-EE4C2C?style=for-the-badge&logo=Pytorch&logoColor=white) 
![OpenAI](https://img.shields.io/badge/OpenAI-412991?style=for-the-badge&logo=OpenAI&logoColor=white) 
![HuggingFace](https://img.shields.io/badge/HuggingFace-F7CB1D?style=for-the-badge&logo=HuggingFace&logoColor=white) 

### Frontend/Backend
![JavaScript](https://img.shields.io/badge/JavaScript-F7DF1E?style=for-the-badge&logo=Javascript&logoColor=white)
![React](https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB)
![MySQL](https://img.shields.io/badge/-MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=ffffff)
![Spring](http://img.shields.io/badge/-Spring-6DB33F?style=for-the-badge&logo=spring&logoColor=ffffff)

### Communication
![Slack](https://img.shields.io/badge/Slack-4A154B?style=for-the-badge&logo=Slack&logoColor=white)
![Notion](https://img.shields.io/badge/Notion-000000?style=for-the-badge&logo=Notion&logoColor=white)
![GoogleMeet](https://img.shields.io/badge/GoogleMeet-00897B?style=for-the-badge&logo=Google%20Meet&logoColor=white)
  
<br>

<div align="center">  
    <h2> Whisper Fine-tuning </h2>
</div>

<h3> Goal </h3>
<ul>
       <li>ë°œìŒì´ ë¶€ì •í™•í•œ ì†Œì•„/ìœ ì•„ ìŒì„±ì— ëŒ€í•´ ë†’ì€ ì¸ì‹ë¥ ì„ ê°€ì§€ëŠ” Speech-to-Text ëª¨ë¸ì„ ê°œë°œí•œë‹¤.</li>
       <li>ìì²´ì ìœ¼ë¡œ êµ¬ì¶•í•œ text datasetì—ì„œ 90% ì´ìƒì˜ ì •í™•ë„ë¥¼ ê°–ëŠ”ë‹¤.</li>
       <li>ì¼ë°˜ë‚¨ì—¬ì˜ ìŒì„±ì¸ì‹ ì •í™•ë„ë˜í•œ ê¸°ì¡´ ëª¨ë¸ë“¤ê³¼ ìœ ì‚¬í•œ ì„±ëŠ¥ì„ ê°–ë„ë¡ í•œë‹¤.</li>
</ul>

<br>

<h3> Dataset </h3>
<ul>
    <li>
        AI Hubì—ì„œ ì œê³µí•˜ëŠ”
           <a href="https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=95">ëª…ë ¹ì–´ ìŒì„±(ì†Œì•„,ìœ ì•„)</a>
            / 
           <a href="https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=96">ëª…ë ¹ì–´ ìŒì„±(ì¼ë°˜ë‚¨ì—¬)</a>
         ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤. 
        <ul>
            <li>Wave íŒŒì¼ : 48kHz(44kHz), 16bit, mono</li>
            <li>Json íŒŒì¼ : Json í¬ë§· ì–´ë…¸í…Œì´ì…˜ ì •ë³´ (ì „ì‚¬ì •ë³´ í¬í•¨)</li>
        </ul>
    </li> 
    <li>Train/Validation(9:1) - ëª…ë ¹ì–´ ìŒì„±(ì†Œì•„,ìœ ì•„) ì˜¤ë””ì˜¤/í…ìŠ¤íŠ¸ ë°ì´í„° 5ë§Œ ê°œ</li>
    <li>Test - ëª…ë ¹ì–´ ìŒì„±(ì†Œì•„,ìœ ì•„) ë°ì´í„° 1ë§Œ ê°œ + ëª…ë ¹ì–´ ìŒì„±(ì¼ë°˜ë‚¨ì—¬) ë°ì´í„° 1ë§Œ ê°œ</li>
</ul>

<br>

<h3> Preprocessing </h3>

1. ë°ì´í„°ì˜ ì „ì‚¬ì •ë³´(json)ì—ì„œ í•„ìš”ì—†ëŠ” ê´„í˜¸, íŠ¹ìˆ˜ë¬¸ì ë° ë…¸ì´ì¦ˆ í‘œê¸° ë“±ì„ ì œê±°í•œë‹¤.
2. ë°ì´í„°ì˜ ì˜¤ë””ì˜¤ íŒŒì¼(wave)ì„ 48kHzâ†’16kHz resampling ë° Z-scoreì •ê·œí™”ë¥¼ ì§„í–‰í•œë‹¤.
3. ê° ë§¤ì¹­ë˜ëŠ” ìŒì„±íŒŒì¼(wave)ì™€ ì „ì‚¬ì •ë³´ íŒŒì¼(json)ì˜ ì¸ë±ìŠ¤ë¥¼ ë™ì¼í•˜ê²Œ í•˜ì—¬, audioì™€ text ë‘ ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°ì´í„°ì…‹ì„ êµ¬ì¶•í•œë‹¤.
4. êµ¬ì¶•í•œ Datasetì€ Hugging-face hubì— ì—…ë¡œë“œí•˜ì—¬ ê´€ë¦¬í•œë‹¤.

ì ê²ŒëŠ” 10,000ê°œ ë§ê²ŒëŠ” 2,070,000ê°œë¡œ ì´ë£¨ì–´ì§€ê³  ìš©ëŸ‰ì´ í° ìŒì„± ë°ì´í„°ì˜ íŠ¹ì„± ìƒ ì—„ì²­ë‚œ ë¦¬ì†ŒìŠ¤ì™€ ì†Œìš”ì‹œê°„ì´ ë°œìƒí•œë‹¤.

â†’ multiprocessing&parmapì„ ì´ìš©í•œ ë³‘ë ¬ì²˜ë¦¬ë¥¼ í†µí•´ í”„ë¡œì„¸ì„œë¥¼ ìµœëŒ€ë¡œ ì‚¬ìš©í•˜ì—¬ **ê¸°ì¡´ ì†Œìš”ì‹œê°„ì˜ 1/10 ì´ìƒ ë‹¨ì¶•**í•˜ì˜€ë‹¤.


<br>

<h3> Base model </h3>

![image](https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/fcd51bc5-5358-4cb9-8ea1-6ad7200a28a2)

Huggingfaceì—ì„œ ì œê³µí•˜ëŠ” [OpenAIì˜ Whisper-large-V2](https://huggingface.co/openai/whisper-large-v2) ëª¨ë¸ì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

<br>

<h3> PEFT-Lora + BNB INT8 fine-tuning </h3>

tiny/small ëª¨ë¸ì„ ë¹„êµí•˜ì˜€ì„ ë•Œ, ëª¨ë¸ ì‚¬ì´ì¦ˆì— ë”°ë¼ ì„±ëŠ¥ ì°¨ì´ê°€ í° ê²ƒì„ í™•ì¸ í›„, ì œì•½ ëœ í™˜ê²½ì—ì„œ Whisper-largeëª¨ë¸ì„ fine-tuningí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ëª¨ìƒ‰ ì¤‘ `LoRA fine-tuning`ê¸°ë²•ì„ ë°œê²¬

ì‚¬ì „ í•™ìŠµëœ ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ê°€ì¤‘ì¹˜ë¥¼ ë¯¸ì„¸ ì¡°ì •í•˜ëŠ” ëŒ€ì‹ , ì´ í° í–‰ë ¬ì„ ê·¼ì‚¬í™”í•˜ëŠ” ë‘ ê°œì˜ ì‘ì€ í–‰ë ¬ì„ ë¯¸ì„¸ ì¡°ì •í•˜ëŠ” ê°œì„ ëœ ë¯¸ì„¸ ì¡°ì • ë°©ì‹

ì´í›„ Hugging-faceì—ì„œ ì œê³µí•˜ëŠ” [PEFT](https://github.com/huggingface/peft)ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•˜ì—¬ í•œì •ëœ GPU Ramì—ì„œ í•˜ì§€ ëª»í–ˆë˜ Whisper-large-v2ëª¨ë¸ì„ RoLA fine-tuningí•œ ê²°ê³¼ child/general ìŒì„± ëª¨ë‘ì—ì„œ ìµœìƒì˜ ì„±ëŠ¥ì„ ë½‘ì•„ë‚´ì—ˆë‹¤.

Reference Code: https://colab.research.google.com/drive/1DOkD_5OUjFa0r5Ik3SgywJLJtEo2qLxO?usp=sharing

<br>

<h3> Result </h3>

![fine-tuned Whisper large-v2 (Best model)](https://github.com/HaseongJung/AIBook/assets/107913513/c11b5dc9-7366-4941-b977-8d3067046e8d)  

- ì „ì²˜ë¦¬í•œ ë°ì´í„°ì…‹ê³¼ fine-tuningí•œ ëª¨ë¸ë“¤ì„ Hugging-face hubë¥¼ í†µí•´ ê´€ë¦¬í•œë‹¤.
    
    [haseong8012/whisper-large-v2_child10K_LoRA Â· Hugging Face](https://huggingface.co/haseong8012/whisper-large-v2_child10K_LoRA)

<br>

<div align="center">  
    <h2> ë™í™”ì±… ìƒì„± </h2>
</div>

<div align="center">  
    <h3> Flowchart </h3>
    <img width="600" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/df644c2c-77cb-481c-897e-4f2b341666cf"/ >
</div>

<div align="center">  
    <h3> GPT-4 </h3>
</div>

<div align="center">  
    <h3> Stable Diffusion </h3>
    <img width="600" src="https://github.com/HaseongJung/AIBook/assets/107913513/d96faf51-2dd8-4989-8803-94fd781d93fa"/ >
    <div>Stable Diffusion - user preference chart</div>
</div>

ê¸°ì¡´ì— [Diffusers](https://huggingface.co/stabilityai/stable-diffusion-xl-refiner-1.0)ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” **Stable Diffusion-XL 1.0**ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ì˜€ì„ ë•Œ, **1ì¥ ë‹¹ ì•½ 25ì´ˆ**ê°€ ì†Œìš”ë˜ì—ˆë‹¤.

â†’ ê¸°ì¡´ì˜ 50ì¶”ë¡ ë‹¨ê³„ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” **[PNDMScheduler](https://huggingface.co/docs/diffusers/v0.26.3/en/api/schedulers/pndm#diffusers.PNDMScheduler)**ë¥¼ 20~25ì¶”ë¡ ë‹¨ê³„ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” **[DPMSolverMultistepScheduler](https://huggingface.co/docs/diffusers/v0.26.3/en/api/schedulers/multistep_dpm_solver#diffusers.DPMSolverMultistepScheduler)**ë¡œ ë³€ê²½í•˜ì—¬ ì„±ëŠ¥ì„ ìœ ì§€í•œ ì±„ `ì´ë¯¸ì§€ ìƒì„±ì‹œê°„ì„ ë‹¨ì¶•`í•˜ì˜€ë‹¤.

â†’ ê¸°ì¡´ SDXL 1.0ëª¨ë¸ì— refinerëª¨ë“ˆì„ ì¶”ê°€í•˜ì—¬ **ì´ë¯¸ì§€ì˜ í’ˆì§ˆì„ í–¥ìƒ**

ì´ë¯¸ì§€ 1ì¥ ë‹¹ ì´ ì†Œìš”ì‹œê°„: SDXL1.0 (ì•½ 6ì´ˆ) +refiner(ì•½ 6ì´ˆ) = ì•½ 12ì´ˆ 

<br>

<div align="center">  
    <h3> Example </h3>
    <img width="700" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/58ab2b08-97cb-4f8e-9202-bb4a1aee020b"/ >
</div>

ì•„ì´ë¶ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ ì±…ì„ ë” ë³´ê³  ì‹¶ë‹¤ë©´

[ë¦¬ë‚˜ì™€ í‰í™”ì˜ ê½ƒ](https://drive.google.com/file/d/1xatQDBDa4JEnTKNGDghhKatAPB7JjYAr/view?usp=sharing)

[ê³ ì–‘ì´ í‚¤í‚¤ì˜ ì±„ì†ŒëŒ€ëª¨í—˜](https://drive.google.com/file/d/1gV0WATR2bVY5ofbfOMpfg4-szvjfDot0/view?usp=sharing)

[ë©”ë¦¬ë‹¤ì˜ ë³„ë¹› ë†€ì´í„°](https://drive.google.com/file/d/1rzZpzoTna6aexnn36GorcXSDN1wnsLHX/view?usp=sharing)

<br>


<div align="center">  
<h2> ğŸ“º UI </h2>
    
<div>
        
| í™ˆ í™”ë©´ | ì£¼ì¸ê³µ ì„ íƒ |
| :--------: | :--------: | 
|  <img width="329" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/e47bfcb1-83ee-46d5-bd7b-8945d1bc48eb"/> |  <img width="329" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/21a2fca2-39ac-48a9-9447-47b661dfdbb3"/>| 

| ì£¼ì œ ì„¤ì • (ìŒì„±ì¸ì‹) | ìƒì„±ì¤‘ | ìƒì„± ì™„ë£Œ |
| :--------: | :--------: | :--------: |
| <img width="329" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/03b52fb8-a907-4614-a789-a06f56e0bdd9"/>   |  <img width="329" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/760c2936-80d4-45de-b9f4-1590728fdaf2"/>     |  <img width="329" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/0f66327d-eb74-40b8-906c-277617408964"/>     |

</div>
    
</div>

<br>

<div align="center">  
    <h2> ğŸ¯ Achievements </h2>
</div>

- [2023 ì„œì´ˆ AIì¹¼ë¦¬ì§€ í”„ë¡œì íŠ¸ ìº¡ìŠ¤í†¤ ë°œí‘œ](https://view.asiae.co.kr/article/2023102721395443490)
- <img width="500" src="https://github.com/user-attachments/assets/ad73c307-6a27-4793-bda8-6e9c2383cc53"/>  
- 2023 ì„œì´ˆ AIì¹¼ë¦¬ì§€ í”„ë¡œì íŠ¸ ê³¼ì • ìš°ìˆ˜íŒ€ ì„ ì •
- **HCI KOREA 2024 í•™ìˆ ëŒ€íšŒ ë…¼ë¬¸ ê²Œì¬ ë° í¬ìŠ¤í„° ë°œí‘œ**
    - [ìƒì„±í˜• AI ê¸°ë°˜ì˜ ë™í™”ì±… ì œì‘ ì„œë¹„ìŠ¤ ì„¤ê³„ ë° êµ¬í˜„. í•œêµ­HCIí•™íšŒ í•™ìˆ ëŒ€íšŒ. í•œêµ­HCIí•™íšŒ. pp. 845-850. 2024.](https://www.dbpia.co.kr/journal/articleDetail?nodeId=NODE11714752)

<div align="center">  
    <img width="570" src="https://github.com/sudaltokki/SeochoAICollege_AIBook/assets/86659995/cf71e321-ecd3-4bfc-b3ea-902b7bacc85c"/>
</div>

<br>

<div align="center">  
    <h2> ğŸï¸ How to use </h2>
</div>

- í˜„ì¬ ê°œë°œí•œ ì›¹ì„œë¹„ìŠ¤ê°€ ë°°í¬ë˜ì–´ìˆì§€ ì•Šìœ¼ë¯€ë¡œ ë¡œì»¬ì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ test.py ì½”ë“œë¥¼ ì˜¬ë ¤ë‘ì—ˆìŠµë‹ˆë‹¤.
- cudaë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°€ìƒí™˜ê²½ì—ì„œ ì‹¤í–‰í•´ì£¼ì„¸ìš”.
- audio fileì„ ì‚¬ìš©í•˜ëŠ” ê³¼ì •ì—ì„œ **ffmpeg ì½”í… ì„¤ì¹˜**ê°€ í•„ìš”í•©ë‹ˆë‹¤. [ë§í¬](https://doa-oh.tistory.com/170?category=757135)ë¥¼ ì°¸ê³ í•´ì„œ ì„¤ì¹˜í•´ì£¼ì„¸ìš”.
- SeochoAICollege_AIBook/AI/generate_book.py ì—ì„œ **OpenAI api key**ë¥¼ ë„£ê³  ì‚¬ìš©í•´ì£¼ì„¸ìš”.

```
git clone https://github.com/sudaltokki/SeochoAICollege_AIBook.git
cd SeochoAICollege_AIBook/AI
pip install -r requirements.txt
python test.py
```
