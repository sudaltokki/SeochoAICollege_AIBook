# AI ë™í™”ì±… ìƒì„± ì„œë¹„ìŠ¤ ì•„ì´ë¶ AI-Book
ì„œì´ˆAIì¹¼ë¦¬ì§€ - ë™í™”ì±… ìƒì„± AIì„œë¹„ìŠ¤ ì•„ì´ë¶
![ì•„ì´ë¶]()

## ğŸ“– í”„ë¡œì íŠ¸ ì†Œê°œ

- ì‚¬ìš©ì ì„¤ì •ì— ë”°ë¼ **ê°œì¸í™”ëœ ë™í™”ì±…**ì„ ìƒì„±í•˜ëŠ” ì¸ê³µì§€ëŠ¥ ê¸°ë°˜ì˜ ì›¹ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.
- ì‚¬ìš©ìëŠ” ì§ì ‘ ë™í™”ì±…ì˜ ì£¼ì¸ê³µê³¼ ì£¼ì œë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì„œë¹„ìŠ¤ì˜ ì£¼ ì‚¬ìš©ìê°€ ì†Œì•„ í˜¹ì€ ìœ ì•„ì¼ ê²ƒì„ ê³ ë ¤í•˜ì—¬ ì‚¬ìš©ìê°€ ë§í•˜ëŠ” ì£¼ì œë¥¼ ìŒì„±ì¸ì‹ìœ¼ë¡œ ë°›ì•„ì˜¤ë„ë¡ ê¸°íší•˜ì˜€ë‹¤. ê·¸ë¦¬ê³  ì •í™•í•œ ìŒì„±ì¸ì‹ì„ ìœ„í•´ Speech to Text ëª¨ë¸ì¸ **OpenAIì˜ Whisper**ì„ **fine-tuning**í•˜ì—¬ ì†Œì•„/ìœ ì•„ ìŒì„±ì— ë” ì í•©í•œ ëª¨ë¸ì„ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤.
- **GPT-4**ì™€ **Stable diffusion**ì„ ì‚¬ìš©í•´ ë™í™”ì±…ì˜ ì œëª©, ë‚´ìš©, ê·¸ë¦¼ì„ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.

![ì•„ì´ë¶ í¬ìŠ¤í„°]()

## ğŸ™‹â€â™‚ï¸ íŒ€ì› êµ¬ì„±
|ë°•ì£¼ì€|ë°•ì§€ì›|ì„ë™í¬|ì •í•˜ì„±|
| :--------: | :--------: | :--------: | :--------: | 
|<img src="" width="120" height="120"/>|<img src="" width="120" height="120"/>|<img src="" width="120" height="120"/>|<img src="" width="120" height="120"/>|
|[@](https://github.com/)|[@sudaltokki](https://github.com/sudaltokki)|[@](https://github.com/)|[@](https://github.com/)|
|Frontend|AI|AI|AI|

## ê°œë°œ í™˜ê²½
- Frontend: React
- Backend: Spring
- AI: 
- í˜‘ì—… íˆ´: Notion, Slack

## Whisper Fine-tuning
- Whisperëª¨ë¸ì„ fine-tuningí•  ë•Œ ì‚¬ìš©í•  ìŒì„± ë°ì´í„°ë¥¼ ì „ì²˜ë¦¬í•œë‹¤
    
    â†’ `ë³‘ë ¬ì²˜ë¦¬ë¥¼ í†µí•´ ê¸°ì¡´ ì†Œìš”ì‹œê°„ì˜ 1/10 ì´ìƒ ê°ì†Œ`
    
- Open AIì˜ Whisperëª¨ë¸ì„ fine-tungingí•˜ì—¬ ìœ ì•„ ìŒì„±ì˜ ì¸ì‹ë¥ ì„ ê°œì„ í•œë‹¤
    
    â†’ `Cer(ìŒì ˆ ì˜¤ë¥˜ìœ¨) ê¸°ì¤€:  11.9 â†’ 1.08`
    
- ì „ì²˜ë¦¬í•œ ë°ì´í„°ì…‹ê³¼ fine-tuningí•œ ëª¨ë¸ë“¤ì„ Hugging-face hubë¥¼ í†µí•´ ê´€ë¦¬í•œë‹¤.
    
    [haseong8012/whisper-large-v2_child10K_LoRA Â· Hugging Face](https://huggingface.co/haseong8012/whisper-large-v2_child10K_LoRA)
    
- Stable Diffusionì—ì„œì˜ ìƒì„±í•˜ëŠ” ì´ë¯¸ì§€ì˜ í’ˆì§ˆì„ í–¥ìƒì‹œí‚¤ê³ , ìƒì„±ì‹œê°„ì„ ë‹¨ì¶•ì‹œí‚¨ë‹¤.
    
    `ê¸°ì¡´ ì´ë¯¸ì§€ 1ì¥ ë‹¹ 25ì´ˆ â†’ 12ì´ˆ`
    

---

## Dataset

AI Hubì—ì„œ ì œê³µí•˜ëŠ” â€˜ëª…ë ¹ì–´ ìŒì„±(ì†Œì•„, ìœ ì•„)â€™ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤.

ë°ì´í„°ì—ëŠ” ê° ìŒì„±ì˜ ì˜¤ë””ì˜¤ íŒŒì¼(wave)ê³¼ ì „ì‚¬ì •ë³´ë¥¼ í¬í•¨í•œ íŒŒì¼(json)ì´ ì¡´ì¬í•œë‹¤.

[AI-Hub](https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=95)

<br>

## Preprocessing

1. ë°ì´í„°ì˜ ì „ì‚¬ì •ë³´(json)ì—ì„œ í•„ìš”ì—†ëŠ” ê´„í˜¸, íŠ¹ìˆ˜ë¬¸ì ë° ë…¸ì´ì¦ˆ í‘œê¸° ë“±ì„ ì œê±°í•œë‹¤.
2. ë°ì´í„°ì˜ ì˜¤ë””ì˜¤ íŒŒì¼(wave)ì„ `48kHzâ†’16kHz` resampling ë° Z-socreì •ê·œí™”ë¥¼ ì§„í–‰í•œë‹¤.
3. ê° ë§¤ì¹­ë˜ëŠ” ìŒì„±íŒŒì¼(wave)ì™€ ì „ì‚¬ì •ë³´ íŒŒì¼(json)ì˜ ì¸ë±ìŠ¤ë¥¼ ë™ì¼í•˜ê²Œ í•˜ì—¬, `audio` ì™€ `text` ë‘ ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë°ì´í„°ì…‹ì„ êµ¬ì¶•í•œë‹¤.
4. êµ¬ì¶•í•œ Datasetì€ Hugging-face hubì— ì—…ë¡œë“œí•˜ì—¬ ê´€ë¦¬í•œë‹¤.

ì ê²ŒëŠ” 10,000ê°œ ë§ê²ŒëŠ” 2,070,000ê°œë¡œ ì´ë£¨ì–´ì§€ê³  ìš©ëŸ‰ì´ í° ìŒì„± ë°ì´í„°ì˜ íŠ¹ì„± ìƒ ì—„ì²­ë‚œ ë¦¬ì†ŒìŠ¤ì™€ ì†Œìš”ì‹œê°„ì´ ë°œìƒí•œë‹¤.

â†’ multiprocessing&parmapì„ ì´ìš©í•œ ë³‘ë ¬ì²˜ë¦¬ë¥¼ í†µí•´ í”„ë¡œì„¸ì„œë¥¼ ìµœëŒ€ë¡œ ì‚¬ìš©í•˜ì—¬ `ê¸°ì¡´ ì†Œìš”ì‹œê°„ì˜ 1/10 ì´ìƒ ë‹¨ì¶•`í•˜ì˜€ë‹¤.

<br>

## Whisper fine-tuning

![whisperì„±ëŠ¥](https://github.com/HaseongJung/AIBook/assets/107913513/2b744cd2-7dd5-4aef-841a-194bf289a827)

OpenAIì˜ whisper ëª¨ë¸ ì„±ëŠ¥

![Whisper ëª¨ë¸ Sizeë³„ ì •ë³´](https://github.com/HaseongJung/AIBook/assets/107913513/c802dc80-1ba8-4411-a5b0-d0627becd600)

Whisper ëª¨ë¸ Sizeë³„ ì •ë³´

- ëŒ€ëŸ‰ì˜ ë‹¤ì–‘í•œ ì–¸ì–´ë“¤ë¡œ ì‚¬ì „ í•™ìŠµë¨
    
    â†’ ì¼ë°˜ ë‚¨ì—¬ì˜ ìŒì„±ì— ëŒ€í•œ ê¸°ë³¸ì ì¸ ì„±ëŠ¥ ë³´ì¥
    
- ì£¼ìš” ì–¸ì–´ê°€ ì•„ë‹Œ í•œêµ­ì–´ì—ì„œëŠ” ë¹„êµì  ë‚®ì€ ì¸ì‹ë„
    
    â†’ fine-tuningì‹œ ì„±ëŠ¥ì´ í–¥ìƒëœ ì—°êµ¬ë¥¼ í†µí•´ ê°€ëŠ¥ì„± í™•ì¸
    

![whisper ì•„í‚¤í…ì²˜](https://github.com/HaseongJung/AIBook/assets/107913513/c8cb4e4a-9e18-4752-b474-8e1c478db001)

Whisper ëª¨ë¸ ì•„í‚¤í…ì²˜

![fine-tuningì‹œ ê³ ë ¤í•  ë³€ìˆ˜](https://github.com/HaseongJung/AIBook/assets/107913513/4f611314-335d-4735-838c-a4a99ec801ee)

fine-tuningì‹œ ê³ ë ¤í•  ë³€ìˆ˜

Whisper fine-tunging ê°€ì´ë“œë¥¼ ì°¸ê³ í•˜ì—¬, Batch size, Learning rate ë° dropout ë“±ê³¼ ê°™ì€ í•˜ì´í¼ íŒŒë¼ë¯¸í„°ëŠ” ê³µì‹ ë¬¸ì„œ ë° ì„ í–‰ ì—°êµ¬ìì˜ ê²°ê³¼ì—ì„œ ë„ì¶œí•œ ì¡°ì–¸ì— ë”°ë¼ ê° í™˜ê²½ì— ë§ì¶”ì–´ì„œ ì§„í–‰í•˜ì˜€ë‹¤. https://github.com/huggingface/community-events/tree/main/whisper-fine-tuning-event#recommended-training-configurations

![Data augmentation ë° lr schedulerì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ](https://github.com/HaseongJung/AIBook/assets/107913513/4d4a9764-2c0e-414b-a62c-209f83029536)

Data augmentation ë° lr schedulerì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ

![Train dataset sizeì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ](https://github.com/HaseongJung/AIBook/assets/107913513/babcdefd-8a5a-415d-ab37-5aba3d1e6bb5)

Train dataset sizeì— ë”°ë¥¸ ì„±ëŠ¥ ë¹„êµ

![fine-tuned Whisper-small (child-50k, linear, adamW)](https://github.com/HaseongJung/AIBook/assets/107913513/2688d21c-2371-44b2-82c6-931655ea61a3)

fine-tuned Whisper-small (child-50k, linear, adamW)

ë°ìŠ¤í¬íƒ‘ ì‚¬ì–‘ ì œì•½ì— ë”°ë¼ Whisper tiny/smallì— ëŒ€í•œ test ë° ì„±ëŠ¥ ë¹„êµ ì§„í–‰í•˜ì˜€ë‹¤.

ìµœì¢…ì ìœ¼ë¡œ augmentaionì„ ì§„í–‰í•˜ì§€ ì•Šê³ , linear lr scheduler, 10kì˜ ë°ì´í„°ì…‹ì„ ì‚¬ìš©í•˜ì—¬ fine-tuningí•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ì€ ê²ƒìœ¼ë¡œ íŒë‹¨í•˜ì˜€ë‹¤.

### LoRA fine-tuning

tiny/small ëª¨ë¸ì„ ë¹„êµí•˜ì˜€ì„ ë•Œ, ëª¨ë¸ ì‚¬ì´ì¦ˆì— ë”°ë¼ ì„±ëŠ¥ ì°¨ì´ê°€ í° ê²ƒì„ í™•ì¸ í›„, ì œì•½ ëœ í™˜ê²½ì—ì„œ Whisper-largeëª¨ë¸ì„ fine-tuningí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ëª¨ìƒ‰ ì¤‘ `LoRA fine-tuning`ê¸°ë²•ì„ ë°œê²¬í•˜ì˜€ë‹¤.

ì‚¬ì „ í•™ìŠµëœ ëŒ€ê·œëª¨ ì–¸ì–´ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ê°€ì¤‘ì¹˜ë¥¼ ë¯¸ì„¸ ì¡°ì •í•˜ëŠ” ëŒ€ì‹ , ì´ í° í–‰ë ¬ì„ ê·¼ì‚¬í™”í•˜ëŠ” ë‘ ê°œì˜ ì‘ì€ í–‰ë ¬ì„ ë¯¸ì„¸ ì¡°ì •í•˜ëŠ” ê°œì„ ëœ ë¯¸ì„¸ ì¡°ì • ë°©ì‹ì´ë‹¤.

![fine-tuned Whisper large-v2 (Best model)](https://github.com/HaseongJung/AIBook/assets/107913513/c11b5dc9-7366-4941-b977-8d3067046e8d)  

fine-tuned Whisper large-v2 (Best model)

ì´í›„ Hugging-faceì—ì„œ ì œê³µí•˜ëŠ” [PEFT](https://github.com/huggingface/peft)ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•˜ì—¬ í•œì •ëœ GPU Ramì—ì„œ í•˜ì§€ ëª»í–ˆë˜ Whisper-large-v2ëª¨ë¸ì„ RoLA fine-tuningí•œ ê²°ê³¼ child/general ìŒì„± ëª¨ë‘ì—ì„œ ìµœìƒì˜ ì„±ëŠ¥ì„ ë½‘ì•„ë‚´ì—ˆë‹¤.

<br>

## Stable Diffusioin

![Stable Diffusion - user preference chart](https://github.com/HaseongJung/AIBook/assets/107913513/d96faf51-2dd8-4989-8803-94fd781d93fa)

Stable Diffusion - user preference chart

ê¸°ì¡´ì— [Diffusers](https://huggingface.co/stabilityai/stable-diffusion-xl-refiner-1.0)ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ì œê³µí•˜ëŠ” `Stable Diffusion-XL 1.0`ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ì˜€ì„ ë•Œ, `1ì¥ ë‹¹ ì•½ 25ì´ˆ`ê°€ ì†Œìš”ë˜ì—ˆë‹¤.

â†’ ê¸°ì¡´ì˜ 50ì¶”ë¡ ë‹¨ê³„ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” **[PNDMScheduler](https://huggingface.co/docs/diffusers/v0.26.3/en/api/schedulers/pndm#diffusers.PNDMScheduler)**ë¥¼ 20~25ì¶”ë¡ ë‹¨ê³„ë¥¼ í•„ìš”ë¡œ í•˜ëŠ” **[DPMSolverMultistepScheduler](https://huggingface.co/docs/diffusers/v0.26.3/en/api/schedulers/multistep_dpm_solver#diffusers.DPMSolverMultistepScheduler)**ë¡œ ë³€ê²½í•˜ì—¬ ì„±ëŠ¥ì„ ìœ ì§€í•œ ì±„ `ì´ë¯¸ì§€ ìƒì„±ì‹œê°„ì„ ë‹¨ì¶•`í•˜ì˜€ë‹¤.

â†’ ê¸°ì¡´ SDXL 1.0ëª¨ë¸ì— refinerëª¨ë“ˆì„ ì¶”ê°€í•˜ì—¬ `ì´ë¯¸ì§€ì˜ í’ˆì§ˆì„ í–¥ìƒ`ì‹œì¼°ë‹¤.

ì´ë¯¸ì§€ 1ì¥ ë‹¹ ì´ ì†Œìš”ì‹œê°„: SDXL1.0 (ì•½ 6ì´ˆ) +refiner(ì•½ 6ì´ˆ) = ì•½ 12ì´ˆ 

<br>

## ğŸ¯ ê²°ê³¼ ë° ì„±ê³¼

- ì„œì´ˆ AIì¹¼ë¦¬ì§€ í”„ë¡œì íŠ¸ ê³¼ì • ìš°ìˆ˜íŒ€ ì„ ì •
- ã€Œìƒì„±í˜• AIê¸°ë°˜ì˜ ë™í™”ì±… ì œì‘ ì„œë¹„ìŠ¤ ì„¤ê³„ ë° êµ¬í˜„ã€, ****HCIK2024 ****
